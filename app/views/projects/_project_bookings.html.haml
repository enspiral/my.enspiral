%div.left-link
  = link_to '+ New Member', new_project_membership_path(:project_id => @project.id), :method => :get

%div.right-link
  =link_to 'Next >>', project_path(:id => @project, :dates => @next_weeks), :method => :get
%div.right-link
  =link_to '<< Previous', project_path(:id => @project, :dates => @previous_weeks), :method => :get

%table.capacity
  %tbody
    %tr
      %th 
        %strong Member
      - @formatted_dates.each do |date|
        %th
          %strong= date
      %th
        %strong Total
      %th &nbsp;

    - @project_bookings.each do |person_id, bookings|
      - project_membership = ProjectMembership.find_by_project_id_and_person_id(@project.id, person_id)
      %tr
        %td.centered  
          #{get_persons_name(person_id)} #{project_membership.is_lead ? '*' : ''}
        - bookings.each do |week, time|
          %td.centered= time
        %td.centered= project_membership.project_bookings.sum('time')
        %td.centered= link_to 'Edit', capacity_edit_path(:person_id => person_id, :project_id => @project.id, :dates => @current_weeks)

    %tr
      %td &nbsp;
    %tr
      %td.centered Project Total
      - for i in (0..4)
        %td &nbsp;
      %td.centered= ProjectBooking.get_projects_total_booked_hours(@project)
